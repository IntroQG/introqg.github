

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Goodness-of-fit calculations &mdash; IntroQG 2017 documentation</title>
  

  
  
  
  

  
  <script type="text/javascript" src="../../_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript">
          var DOCUMENTATION_OPTIONS = {
              URL_ROOT:'../../',
              VERSION:'2017',
              LANGUAGE:'None',
              COLLAPSE_INDEX:false,
              FILE_SUFFIX:'.html',
              HAS_SOURCE:  true,
              SOURCELINK_SUFFIX: '.txt'
          };
      </script>
        <script type="text/javascript" src="../../_static/jquery.js"></script>
        <script type="text/javascript" src="../../_static/underscore.js"></script>
        <script type="text/javascript" src="../../_static/doctools.js"></script>
        <script type="text/javascript" src="https://www.googletagmanager.com/gtag/js?id=UA-92357604-2"></script>
        <script type="text/javascript" src="../../_static/google_analytics_tracker.js"></script>
        <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    
    <script type="text/javascript" src="../../_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/banner.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/theme_overrides.css" type="text/css" />
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="Least squares regressions" href="least-squares.html" />
    <link rel="prev" title="Lecture" href="lesson-video.html" />
    <link href="../../_static/style.css" rel="stylesheet" type="text/css">

</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../../index.html" class="icon icon-home"> IntroQG
          

          
            
            <img src="../../_static/QG-logo-2017.png" class="logo" alt="Logo"/>
          
          </a>

          
            
            
              <div class="version">
                2017
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Course information</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../general-info/course-details.html">Course details</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../general-info/grading.html">Grading</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../general-info/licensing.html">Content licenses</a></li>
</ul>
<p class="caption"><span class="caption-text">Lesson 8</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../L8/overview.html">Lesson 8 overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="../L8/lesson-video.html">Lecture</a></li>
<li class="toctree-l1"><a class="reference internal" href="../L8/intro-numpy.html">Introduction to NumPy</a></li>
<li class="toctree-l1"><a class="reference internal" href="../L8/basic-terms.html">Basic statistical terms and concepts</a></li>
<li class="toctree-l1"><a class="reference internal" href="../L8/uncertainty.html">Uncertainty</a></li>
<li class="toctree-l1"><a class="reference internal" href="../L8/reporting-measurements.html">Reporting measurements</a></li>
<li class="toctree-l1"><a class="reference internal" href="../L8/normal-distribution.html">The normal distribution</a></li>
<li class="toctree-l1"><a class="reference internal" href="../L8/ex-8.html">Exercise 8</a></li>
<li class="toctree-l1"><a class="reference internal" href="../L8/exercise-8-hints.html">Hints for Exercise 8</a></li>
</ul>
<p class="caption"><span class="caption-text">Lesson 9</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="overview.html">Lesson 9 overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="lesson-video.html">Lecture</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Goodness-of-fit calculations</a></li>
<li class="toctree-l1"><a class="reference internal" href="least-squares.html">Least squares regressions</a></li>
<li class="toctree-l1"><a class="reference internal" href="ex-9.html">Exercise 9</a></li>
<li class="toctree-l1"><a class="reference internal" href="exercise-9-hints.html">Hints for Exercise 9</a></li>
</ul>
<p class="caption"><span class="caption-text">Lesson 10</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../L10/overview.html">Lesson 10 overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="../L10/lesson-video.html">Lecture</a></li>
<li class="toctree-l1"><a class="reference internal" href="../L10/solving-diffusion.html">Solving the diffusion equation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../L10/ex-10.html">Exercise 10</a></li>
<li class="toctree-l1"><a class="reference internal" href="../L10/exercise-10-hints.html">Hints for Exercise 10</a></li>
</ul>
<p class="caption"><span class="caption-text">Lesson 11</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../L11/overview.html">Lesson 11 overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="../L11/lesson-video.html">Lecture</a></li>
<li class="toctree-l1"><a class="reference internal" href="../L11/solving-advection.html">Solving the advection-diffusion equation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../L11/ex-11.html">Exercise 11</a></li>
<li class="toctree-l1"><a class="reference internal" href="../L11/exercise-11-hints.html">Hints for Exercise 11</a></li>
</ul>
<p class="caption"><span class="caption-text">Lesson 12</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../L12/overview.html">Lesson 12 overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="../L12/lesson-video.html">Lecture</a></li>
<li class="toctree-l1"><a class="reference internal" href="../L12/viscous-flows.html">Viscous flow down an incline</a></li>
<li class="toctree-l1"><a class="reference internal" href="../L12/exercise-12-theory.html">Theory for Exercise 12</a></li>
<li class="toctree-l1"><a class="reference internal" href="../L12/ex-12.html">Exercise 12</a></li>
<li class="toctree-l1"><a class="reference internal" href="../L12/exercise-12-hints.html">Hints for Exercise 12</a></li>
</ul>
<p class="caption"><span class="caption-text">Lesson 13</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../L13/overview.html">Lesson 13 overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="../L13/lesson-video.html">Lecture</a></li>
<li class="toctree-l1"><a class="reference internal" href="../L13/ex-13.html">Exercise 13</a></li>
<li class="toctree-l1"><a class="reference internal" href="../L13/exercise-13-hints.html">Hints for Exercise 13</a></li>
</ul>
<p class="caption"><span class="caption-text">Lesson 14</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../L14/overview.html">Lesson 14 overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="../L14/lesson-video.html">Lecture</a></li>
<li class="toctree-l1"><a class="reference internal" href="../L14/ex-14.html">Exercise 14</a></li>
<li class="toctree-l1"><a class="reference internal" href="../L14/exercise-14-hints.html">Hints for Exercise 14</a></li>
</ul>
<p class="caption"><span class="caption-text">Final report</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../final-paper/final-report.html">Final paper information</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../final-paper/articles.html">Scientific articles for the final paper</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">IntroQG</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../../index.html">Docs</a> &raquo;</li>
        
      <li>Goodness-of-fit calculations</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../../_sources/lessons/L9/goodness-of-fit.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  


    
    



    <p class="scv-banner scv-sphinx_rtd_theme"><b>Warning:</b> This document is for an old version of IntroQG.</p>
<div class="section" id="goodness-of-fit-calculations">
<h1>Goodness-of-fit calculations<a class="headerlink" href="#goodness-of-fit-calculations" title="Permalink to this headline">¶</a></h1>
<p>A <em>goodness-of-fit</em> calculation provides a way in which we can assess how well a set of predictions “fit” some observed or measured values (data).
Often, this kind of calculation is useful because it can provide a single number to quantify how well a set of predictions matches some data.
If we consider a very simple case, let’s say we have a single mean geochronological age for a rock sample with its uncertainty (the standard deviation for the individual grain ages in the sample in this case).
We might visually represent this data as a point to display the mean and an error bar to show the standard deviation as shown below in Figure 1.</p>
<div class="figure align-center" id="id1">
<a class="reference internal image-reference" href="../../_images/data-and-predictions.png"><img alt="Data and predictions" src="../../_images/data-and-predictions.png" style="width: 500px;" /></a>
<p class="caption"><span class="caption-text">Figure 1. A measured age (blue circle) with its uncertainty as an errorbar and two predicted ages (white squares).</span></p>
</div>
<p>In this scenario, we might reasonably consider one of the predicted ages to have a “good” fit to the data if the predicted age is within the uncertainty of the measured age.
Thus, the predicted age on the left “fits” the data, whereas the predicted age on the right does not.
The general idea is that <strong>the predictions should be within the uncertainty in the data to be considered a “good” fit to the data</strong>.</p>
<p>Keeping in mind the idea that predictions should be within data uncertainties we can now consider some of the basic <em>goodness-of-fit</em> calculations.
The first example is the <em>weighted sum of the squared errors</em>, also often refered to simply as chi squared:</p>
<div class="math notranslate nohighlight">
\[\chi^{2} = \sum \frac{(O_{i} - E_{i})^{2}}{\sigma_{i}^{2}}\]</div>
<p>where <span class="math notranslate nohighlight">\(O_{i}\)</span> is the <span class="math notranslate nohighlight">\(i\)</span>th measured mean age, <span class="math notranslate nohighlight">\(E_{i}\)</span> is the <span class="math notranslate nohighlight">\(i\)</span>th predicted age, and <span class="math notranslate nohighlight">\(\sigma_{i}\)</span> is the <span class="math notranslate nohighlight">\(i\)</span>th standard deviation.</p>
<p>This equation is quite simple in terms of the concept.
First, the difference between the mean age and the prediction is calculated and then squared.
This ensures that we are only considering the magnitude in the difference in the values, not whether the prediction is smaller or greater than the mean of the data.
Second, the calculated difference is divided by the standard deviation squared.
If the standard deviation is simply how much a value differs from the mean on average, then dividing by the standard deviation should allow us to see whether or not a prediction is within the uncertainty.
How?
Let’s consider some examples.</p>
<ol class="arabic simple">
<li>If we assume that the mean value in the data and the prediction are identical, then their difference is zero, and the value of the chi-squared equation for that data point would also be zero.</li>
<li>If the prediction is exactly 1 standard deviation larger or smaller than the mean of the data, then the difference would be exactly the standard deviation <span class="math notranslate nohighlight">\(\sigma\)</span>, in which case the chi-squared value for that data point would be <span class="math notranslate nohighlight">\(\sigma^{2} / \sigma^{2}\)</span>, which equals 1.</li>
</ol>
<p>Thus, for any prediction that falls within the data uncertainty, the chi-squared value for that prediction should be <strong>less than or equal to 1</strong>, with a minimum of zero.
Any value that falls outside the data uncertainty would thus have a chi-squared value of <strong>greater than 1</strong>.
Unfortunately, since these values for each data point are summed together, it can be a bit difficult to look at just the value of chi squared to determine how well some predictions match some data, unless the value is very close to 1.</p>
<p>An alternative formulation of the <em>weighted sum of the squared errors</em> attempts to make the values slightly easier to interpret by dividing by the number of values used in the calculation, as shown below.</p>
<div class="math notranslate nohighlight">
\[\chi^{2} = \frac{1}{N} \sum \frac{(O_{i} - E_{i})^{2}}{\sigma_{i}^{2}}\]</div>
<p>where <span class="math notranslate nohighlight">\(N\)</span> is the number of values in the summation.</p>
<p>The change above is simple, we’re just dividing the calculated chi-squared value by the number of values used in the summation <span class="math notranslate nohighlight">\(N\)</span>.
The advantage here is that now a value of 1.0 or less tells us that on average the predictions are within the uncertainties in the data, and a value of greater than 1.0 says that on average the predictions are not within the uncertainties of the data.</p>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="least-squares.html" class="btn btn-neutral float-right" title="Least squares regressions" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="lesson-video.html" class="btn btn-neutral float-left" title="Lecture" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2017, David Whipp, University of Helsinki
      <span class="lastupdated">
        Last updated on Nov 05, 2017.
      </span>

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
    <p><br/><a rel="license" href="http://creativecommons.org/licenses/by-sa/4.0/"><img alt="Creative Commons License" style="border-width:0" src="https://i.creativecommons.org/l/by-sa/4.0/88x31.png" /></a><br /></a></p>
     


</footer>

        </div>
      </div>

    </section>

  </div>
  
<div class="rst-versions" data-toggle="rst-versions" role="note" aria-label="versions">
    <span class="rst-current-version" data-toggle="rst-current-version">
        <span class="fa fa-book"> Other Versions</span>
        v: v2017
        <span class="fa fa-caret-down"></span>
    </span>
    <div class="rst-other-versions">
        <dl>
            <dt>Tags</dt>
            <dd><a href="goodness-of-fit.html">v2017</a></dd>
            <dd><a href="../../../v2018/index.html">v2018</a></dd>
        </dl>
        <dl>
            <dt>Branches</dt>
            <dd><a href="../../../develop/index.html">develop</a></dd>
            <dd><a href="../../../master/index.html">master</a></dd>
        </dl>
    </div>
</div>


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>