

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  <script type="text/javascript">

      var _gaq = _gaq || [];
      _gaq.push(['_setAccount', 'UA-92357604-2']);
      _gaq.push(['_trackPageview']);

      (function() {
        var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
        ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
        var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
      })();
    </script>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Solving the advection-diffusion equation &mdash; IntroQG 2018 documentation</title>
  

  
  
  
  

  
  <script type="text/javascript" src="../../_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript">
          var DOCUMENTATION_OPTIONS = {
              URL_ROOT:'../../',
              VERSION:'2018',
              LANGUAGE:'None',
              COLLAPSE_INDEX:false,
              FILE_SUFFIX:'.html',
              HAS_SOURCE:  true,
              SOURCELINK_SUFFIX: '.txt'
          };
      </script>
        <script type="text/javascript" src="../../_static/jquery.js"></script>
        <script type="text/javascript" src="../../_static/underscore.js"></script>
        <script type="text/javascript" src="../../_static/doctools.js"></script>
        <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
        <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    
    <script type="text/javascript" src="../../_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/banner.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/theme_overrides.css" type="text/css" />
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="Exercise 4" href="exercise-4.html" />
    <link rel="prev" title="Lesson 4 overview" href="overview.html" />
    <link href="../../_static/style.css" rel="stylesheet" type="text/css">

</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../../index.html" class="icon icon-home"> IntroQG
          

          
            
            <img src="../../_static/HY-logo.png" class="logo" alt="Logo"/>
          
          </a>

          
            
            
              <div class="version">
                2018
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Course information</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../general-info/course-details.html">Course details</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../general-info/course-details.html#course-meetings">Course meetings</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../general-info/course-details.html#instructors">Instructors</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../general-info/course-details.html#course-website">Course website</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../general-info/course-details.html#textbooks">Textbooks</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../general-info/grading.html">Grading</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../general-info/grading.html#general-grading-breakdown">General grading breakdown</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../general-info/licensing.html">Content licenses</a></li>
</ul>
<p class="caption"><span class="caption-text">Lesson 1</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../L1/overview.html">Lesson overview</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../L1/overview.html#learning-objectives">Learning objectives</a></li>
<li class="toctree-l2"><a class="reference internal" href="../L1/overview.html#lesson-video">Lesson video</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../notebooks/L1/numpy.html">A few more useful NumPy functions</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../notebooks/L1/numpy.html#Getting-started">Getting started</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../notebooks/L1/numpy.html#Defining-arrays-with-a-fixed-number-of-increments">Defining arrays with a fixed number of increments</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../notebooks/L1/numpy.html#Defining-arrays-with-a-fixed-increment-between-values">Defining arrays with a fixed increment between values</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../L1/basic-terms.html">Basic statistical terms and concepts</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../L1/basic-terms.html#populations-and-samples">Populations and samples</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../L1/uncertainty.html">Uncertainty</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../L1/uncertainty.html#some-general-uncertainty-concepts">Some general uncertainty concepts</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../L1/reporting-measurements.html">Reporting measurements</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../L1/reporting-measurements.html#reporting-a-measured-value">Reporting a measured value</a></li>
<li class="toctree-l2"><a class="reference internal" href="../L1/reporting-measurements.html#standard-deviation-versus-standard-error">Standard deviation versus standard error</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../L1/normal-distribution.html">The normal distribution</a></li>
<li class="toctree-l1"><a class="reference internal" href="../L1/exercise-1.html">Exercise 1</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../L1/exercise-1.html#general-hints-for-exercise-1">General hints for Exercise 1</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../L1/exercise-1.html#sigma-notation">Sigma notation</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../L1/exercise-1.html#problem-1">Problem 1</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../L1/exercise-1.html#function-docstrings">Function docstrings</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../L1/exercise-1.html#problem-2">Problem 2</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../L1/exercise-1.html#example-plot-for-problem-2">Example plot for Problem 2</a></li>
<li class="toctree-l3"><a class="reference internal" href="../L1/exercise-1.html#creating-arrays-of-numbers-between-two-values">Creating arrays of numbers between two values</a></li>
<li class="toctree-l3"><a class="reference internal" href="../L1/exercise-1.html#creating-and-appending-to-lists">Creating and appending to lists</a></li>
<li class="toctree-l3"><a class="reference internal" href="../L1/exercise-1.html#plotting-similar-items-using-a-for-loop">Plotting similar items using a for loop</a></li>
</ul>
</li>
</ul>
</li>
</ul>
<p class="caption"><span class="caption-text">Lesson 2</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../L2/overview.html">Lesson overview</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../L2/overview.html#learning-objectives">Learning objectives</a></li>
<li class="toctree-l2"><a class="reference internal" href="../L2/overview.html#lesson-video">Lesson video</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../L2/goodness-of-fit.html">Goodness-of-fit calculations</a></li>
<li class="toctree-l1"><a class="reference internal" href="../L2/least-squares.html">Least squares regressions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../L2/exercise-2.html">Exercise 2</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../L2/exercise-2.html#general-hints-for-exercise-2">General hints for Exercise 2</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../L2/exercise-2.html#formatting-numbers-in-python">Formatting numbers in Python</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../L2/exercise-2.html#hints-for-problem-1">Hints for Problem 1</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../L2/exercise-2.html#calculating-summations">Calculating summations</a></li>
<li class="toctree-l3"><a class="reference internal" href="../L2/exercise-2.html#shorthand-python-notation-for-adding-to-a-variable">Shorthand Python notation for adding to a variable</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../L2/exercise-2.html#hints-for-problem-2">Hints for Problem 2</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../L2/exercise-2.html#returning-more-than-one-value">Returning more than one value</a></li>
<li class="toctree-l3"><a class="reference internal" href="../L2/exercise-2.html#plotting-your-regression-lines">Plotting your regression lines</a></li>
</ul>
</li>
</ul>
</li>
</ul>
<p class="caption"><span class="caption-text">Lesson 3</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../L3/overview.html">Lesson 3 overview</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../L3/overview.html#learning-objectives">Learning objectives</a></li>
<li class="toctree-l2"><a class="reference internal" href="../L3/overview.html#lesson-video">Lesson video</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../L3/solving-diffusion.html">Solving the diffusion equation</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../L3/solving-diffusion.html#goals">Goals</a></li>
<li class="toctree-l2"><a class="reference internal" href="../L3/solving-diffusion.html#general-requirements-diffusion">General requirements - diffusion</a></li>
<li class="toctree-l2"><a class="reference internal" href="../L3/solving-diffusion.html#hillslope-transport">Hillslope transport</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../L3/solving-diffusion.html#transfer-proportional-to-gradient">Transfer proportional to gradient</a></li>
<li class="toctree-l3"><a class="reference internal" href="../L3/solving-diffusion.html#mass-conservation">Mass conservation</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../L3/solving-diffusion.html#diffusion-equation-for-hillslope-transport">Diffusion equation for hillslope transport</a></li>
<li class="toctree-l2"><a class="reference internal" href="../L3/solving-diffusion.html#solving-the-diffusion-equation-in-steady-state">Solving the diffusion equation in steady state</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../L3/solving-diffusion.html#general-scenario">General scenario</a></li>
<li class="toctree-l3"><a class="reference internal" href="../L3/solving-diffusion.html#applying-the-boundary-conditions">Applying the boundary conditions</a></li>
<li class="toctree-l3"><a class="reference internal" href="../L3/solving-diffusion.html#finding-integration-constant-1">Finding integration constant 1</a></li>
<li class="toctree-l3"><a class="reference internal" href="../L3/solving-diffusion.html#finding-integration-constant-2">Finding integration constant 2</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../L3/solving-diffusion.html#features-of-our-predictive-model">Features of our predictive model</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../L3/exercise-3.html">Exercise 3</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../L3/exercise-3.html#hints-for-exercise-3">Hints for Exercise 3</a></li>
</ul>
</li>
</ul>
<p class="caption"><span class="caption-text">Lesson 4</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="overview.html">Lesson 4 overview</a><ul>
<li class="toctree-l2"><a class="reference internal" href="overview.html#learning-objectives">Learning objectives</a></li>
<li class="toctree-l2"><a class="reference internal" href="overview.html#lesson-video">Lesson video</a></li>
</ul>
</li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Solving the advection-diffusion equation</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#goals-of-these-notes">Goals of these notes</a></li>
<li class="toctree-l2"><a class="reference internal" href="#advection-diffusion-equation-in-1d">Advection-diffusion equation in 1D</a></li>
<li class="toctree-l2"><a class="reference internal" href="#solutions-to-the-steady-state-advection-diffusion-equation">Solutions to the steady-state advection-diffusion equation</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#constant-gradient-at-surface">Constant gradient <span class="math notranslate nohighlight">\(g\)</span> at surface</a></li>
<li class="toctree-l3"><a class="reference internal" href="#constant-temperature-at">Constant temperature <span class="math notranslate nohighlight">\(T_{L}\)</span> at <span class="math notranslate nohighlight">\(z=L\)</span></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#the-peclet-number">The Peclet number</a></li>
<li class="toctree-l2"><a class="reference internal" href="#advection-diffusion-equation-take-home-messages">Advection-diffusion equation take-home messages</a></li>
<li class="toctree-l2"><a class="reference internal" href="#caveats">Caveats</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="exercise-4.html">Exercise 4</a><ul>
<li class="toctree-l2"><a class="reference internal" href="exercise-4.html#hints-for-exercise-4">Hints for Exercise 4</a><ul>
<li class="toctree-l3"><a class="reference internal" href="exercise-4.html#p1-calculating-dh-dt-see-also-hint-below">P1: Calculating dh/dt (see also hint below)</a></li>
<li class="toctree-l3"><a class="reference internal" href="exercise-4.html#p1-calculating-the-topography-slope">P1: Calculating the topography slope</a></li>
<li class="toctree-l3"><a class="reference internal" href="exercise-4.html#p2-passing-returning-figure-objects">P2: Passing/returning figure objects</a></li>
<li class="toctree-l3"><a class="reference internal" href="exercise-4.html#p2-units">P2: Units</a></li>
</ul>
</li>
</ul>
</li>
</ul>
<p class="caption"><span class="caption-text">Lesson 5</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../L5/overview.html">Lesson 5 overview</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../L5/overview.html#learning-objectives">Learning objectives</a></li>
<li class="toctree-l2"><a class="reference internal" href="../L5/overview.html#lesson-video">Lesson video</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../L5/viscous-flows.html">Viscous flow down an incline</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../L5/viscous-flows.html#goals">Goals</a></li>
<li class="toctree-l2"><a class="reference internal" href="../L5/viscous-flows.html#linear-viscous-flow">Linear viscous flow</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../L5/viscous-flows.html#shear-stress-in-the-fluid">Shear stress in the fluid</a></li>
<li class="toctree-l3"><a class="reference internal" href="../L5/viscous-flows.html#linking-to-viscous-flow">Linking to viscous flow</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../L5/viscous-flows.html#viscous-flow-take-home-messages">Viscous flow take-home messages</a></li>
<li class="toctree-l2"><a class="reference internal" href="../L5/viscous-flows.html#caveats">Caveats</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../L5/exercise-5-theory.html">Theory for Exercise 5</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../L5/exercise-5-theory.html#problem-1">Problem 1</a></li>
<li class="toctree-l2"><a class="reference internal" href="../L5/exercise-5-theory.html#problem-2">Problem 2</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../L5/exercise-5.html">Exercise 5</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../L5/exercise-5.html#hints-for-exercise-5">Hints for Exercise 5</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../L5/exercise-5.html#p1-solving-for-the-unknown-pressures-in-equation-10">P1: Solving for the unknown pressures in Equation 10</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../L5/exercise-5.html#problem-2">Problem 2</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../L5/exercise-5.html#solving-for-the-unknown-term-in-equation-19">Solving for the unknown term in Equation 19</a></li>
</ul>
</li>
</ul>
</li>
</ul>
<p class="caption"><span class="caption-text">Lesson 6</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../L6/overview.html">Lesson 6 overview</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../L6/overview.html#scientific-journal-articles">Scientific journal articles</a></li>
<li class="toctree-l2"><a class="reference internal" href="../L6/overview.html#additional-materials">Additional materials</a></li>
<li class="toctree-l2"><a class="reference internal" href="../L6/overview.html#lesson-video">Lesson video</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../L6/exercise-6.html">Exercise 6</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../L6/exercise-6.html#hints-for-exercise-6">Hints for Exercise 6</a></li>
</ul>
</li>
</ul>
<p class="caption"><span class="caption-text">Lesson 7</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../L7/overview.html">Lesson 7 overview</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../L7/overview.html#scientific-journal-articles">Scientific journal articles</a></li>
<li class="toctree-l2"><a class="reference internal" href="../L7/overview.html#additional-materials">Additional materials</a></li>
<li class="toctree-l2"><a class="reference internal" href="../L7/overview.html#lesson-video">Lesson video</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../L7/exercise-7.html">Exercise 7</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../L7/exercise-7.html#hints-for-exercise-7">Hints for Exercise 7</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../L7/exercise-7.html#removing-9999-age-values">Removing <code class="docutils literal notranslate"><span class="pre">-9999</span></code> age values</a></li>
<li class="toctree-l3"><a class="reference internal" href="../L7/exercise-7.html#comparing-a-single-predicted-age-to-multiple-measured-ages">Comparing a single predicted age to multiple measured ages</a></li>
<li class="toctree-l3"><a class="reference internal" href="../L7/exercise-7.html#problem-1-part-4-example-plot">Problem 1, Part 4 example plot</a></li>
<li class="toctree-l3"><a class="reference internal" href="../L7/exercise-7.html#plotting-predicted-ages-as-horizontal-lines">Plotting predicted ages as horizontal lines</a></li>
</ul>
</li>
</ul>
</li>
</ul>
<p class="caption"><span class="caption-text">Final report</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../final-paper/final-report.html">Final paper information</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../final-paper/final-report.html#abstract">Abstract</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../final-paper/final-report.html#introduction-2-4-paragraphs">Introduction (2-4 paragraphs)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../final-paper/final-report.html#geological-background-1-3-paragraphs">Geological background (1-3 paragraphs)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../final-paper/final-report.html#methods-at-least-1-paragraph">Methods (at least 1 paragraph)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../final-paper/final-report.html#results-at-least-1-paragraph">Results (at least 1 paragraph)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../final-paper/final-report.html#discussion-several-paragraphs">Discussion (several paragraphs)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../final-paper/final-report.html#conclusions-summary-1-2-paragraphs">Conclusions/Summary (1-2 paragraphs)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../final-paper/final-report.html#references">References</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../final-paper/final-report.html#appendices">Appendices</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../final-paper/final-report.html#grading-rubric">Grading rubric</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../final-paper/articles.html">Scientific articles for the final paper</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../final-paper/articles.html#general-thermochronology-papers">General thermochronology papers</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../final-paper/articles.html#himalaya-review-papers">Himalaya review papers</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../final-paper/articles.html#bhutan-himalaya-papers">Bhutan Himalaya papers</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../final-paper/template.html">Final paper template</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">IntroQG</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../../index.html">Docs</a> &raquo;</li>
        
      <li>Solving the advection-diffusion equation</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            
              <a href="https://github.com/IntroQG/qg/blob/2018/source/lessons/L4/solving-advection.rst" class="fa fa-github"> Edit on GitHub</a>
            
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  


    
    



    <p class="scv-banner scv-sphinx_rtd_theme"><a href="../../../master/lessons/L4/solving-advection.html"><b>Warning:</b> This document is for an old version of IntroQG. The main version is master.</a></p>

<style>
/* CSS overrides for sphinx_rtd_theme */

/* 24px margin */
.nbinput.nblast,
.nboutput.nblast {
    margin-bottom: 19px;  /* padding has already 5px */
}

/* ... except between code cells! */
.nblast + .nbinput {
    margin-top: -19px;
}

.admonition > p:before {
    margin-right: 4px;  /* make room for the exclamation icon */
}

/* Fix math alignment, see https://github.com/rtfd/sphinx_rtd_theme/pull/686 */
.math {
    text-align: unset;
}
</style>
<div class="section" id="solving-the-advection-diffusion-equation">
<h1>Solving the advection-diffusion equation<a class="headerlink" href="#solving-the-advection-diffusion-equation" title="Permalink to this headline">¶</a></h1>
<div class="section" id="goals-of-these-notes">
<h2>Goals of these notes<a class="headerlink" href="#goals-of-these-notes" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li>Introduce the advection-diffusion equation</li>
<li>Find solution for steady-state heat transfer with a constant surface heat flux</li>
<li>Find solution for steady-state heat transfer with a constant basal temperature</li>
</ul>
</div>
<div class="section" id="advection-diffusion-equation-in-1d">
<h2>Advection-diffusion equation in 1D<a class="headerlink" href="#advection-diffusion-equation-in-1d" title="Permalink to this headline">¶</a></h2>
<p>To show how the advection equation can be solved, we’re actually going to look at a combination of the advection and diffusion equations applied to heat transfer.
We’re looking at heat transfer in part because many solutions exist to the heat transfer equations in 1D, with math that is straightforward to follow.
Heat conduction is a diffusion process caused by interactions of atoms or molecules, which can be simulated using the diffusion equation we saw in last week’s notes.
Heat advection refers to the heat transferred by physical movement of materials, such as by the motion of faults.
Fault movement, for instance, may bring relatively warm rocks up toward the surface where they begin to cool by heat conduction.
Advection and conduction are also commonly applied to simulate 1D heat transfer by processes such as sedimentation and erosion.</p>
<p>Mathematically, we’ll start with our two equations: (1) The diffusion equation without heat production and (2) the advection equation, then combine them.</p>
<div class="math notranslate nohighlight">
\[\begin{split}\frac{\partial T}{\partial t} &amp;= \kappa \frac{\partial^{2} T}{\partial z^{2}} &amp;&amp; \text{ Diffusion}\\
\frac{\partial T}{\partial t} &amp;= v_{z}\frac{\partial T}{\partial z} &amp;&amp; \text{ Advection}\\
\frac{\partial T}{\partial t} &amp;= \kappa \frac{\partial^{2} T}{\partial z^{2}} + v_{z}\frac{\partial T}{\partial z} &amp;&amp; \text{ Diffusion + Advection}\end{split}\]</div>
<p>In steady state, we can ignore the transient term <span class="math notranslate nohighlight">\(\partial T/\partial t\)</span>, so</p>
<div class="math notranslate nohighlight">
\[\begin{split}\require{cancel}
\cancelto{0}{\frac{\partial T}{\partial t}} &amp;= \kappa \frac{\partial^{2} T}{\partial z^{2}} + v_{z}\frac{\partial T}{\partial z} &amp;&amp; \text{ Steady-state advection-diffusion equation}\\
\frac{\partial^{2} T}{\partial z^{2}} &amp;= -\frac{v_{z}}{\kappa} \frac{\partial T}{\partial z} &amp;&amp; \text{ Rearranged}\\\end{split}\]</div>
<p>Another way to write the previous equation is</p>
<div class="math notranslate nohighlight">
\[\frac{\partial}{\partial z} \left(\frac{\partial T}{\partial z}\right) = -\frac{v_{z}}{\kappa} \frac{\partial T}{\partial z}\]</div>
<p>In this case, we can make some substitutions and find something quite useful.
Assume <span class="math notranslate nohighlight">\(f = \partial T/\partial z\)</span> and <span class="math notranslate nohighlight">\(c = v_{z}/\kappa\)</span>.
With this, we can say <span class="math notranslate nohighlight">\(f'(z) = -c f(z):math:\)</span>.
This is a common form of differential equation with a solution <span class="math notranslate nohighlight">\(f(z) = f(0) \mathrm{e}^{cz}\)</span>.
Thus, in terms of our equation we can say</p>
<div class="math notranslate nohighlight">
\[\frac{\partial T}{\partial z} = \left. -\frac{\partial T}{\partial z} \right|_{(z = 0)} \mathrm{e}^{-(v_{z} z/\kappa)}\]</div>
</div>
<div class="section" id="solutions-to-the-steady-state-advection-diffusion-equation">
<h2>Solutions to the steady-state advection-diffusion equation<a class="headerlink" href="#solutions-to-the-steady-state-advection-diffusion-equation" title="Permalink to this headline">¶</a></h2>
<div class="section" id="constant-gradient-at-surface">
<h3>Constant gradient <span class="math notranslate nohighlight">\(g\)</span> at surface<a class="headerlink" href="#constant-gradient-at-surface" title="Permalink to this headline">¶</a></h3>
<p>The simplest solution to the previous equation is to assume a constant temperature gradient <span class="math notranslate nohighlight">\(g\)</span> at <span class="math notranslate nohighlight">\(z=0\)</span>.</p>
<div class="math notranslate nohighlight">
\[\begin{split}\frac{\partial T}{\partial z} &amp;= \left. -\frac{\partial T}{\partial z} \right|_{(z = 0)} \mathrm{e}^{-(v_{z} z/\kappa)} = g \mathrm{e}^{-(v_{z} z/\kappa)}\\
\int \frac{\partial T}{\partial z} &amp;= g \int \mathrm{e}^{-(v_{z} z/\kappa)} &amp;&amp; \text{Integrate}\\
T(z) &amp;= -\frac{g \kappa}{v_{z}} \mathrm{e}^{-(v_{z} z/\kappa)} + c_{1}\end{split}\]</div>
<p>Assume <span class="math notranslate nohighlight">\(T(0) = 0\)</span>.</p>
<div class="math notranslate nohighlight">
\[\begin{split}T(z) &amp;= -\frac{g \kappa}{v_{z}} \mathrm{e}^{-(v_{z} z/\kappa)} + c_{1}\\
0 &amp;= -\frac{g \kappa}{v_{z}} \cancelto{1}{\mathrm{e}^{-(v_{z} 0/\kappa)}} + c_{1}\\
c_{1} &amp;= \frac{g \kappa}{v_{z}}\end{split}\]</div>
<p>Thus, we find</p>
<div class="math notranslate nohighlight">
\[\begin{split}T(z) &amp;= -\frac{g \kappa}{v_{z}} \mathrm{e}^{-(v_{z} z/\kappa)} + \frac{g \kappa}{v_{z}}\\
T(z) &amp;= \frac{g \kappa}{v_{z}}\left(1 - \mathrm{e}^{-(v_{z} z/\kappa)} \right) &amp;&amp; \text{Rearranged}\end{split}\]</div>
<div class="admonition attention">
<p class="first admonition-title">Attention</p>
<p>What should our temperature profile look like?</p>
<p class="last">At constant <span class="math notranslate nohighlight">\(z\)</span>, what happens to <span class="math notranslate nohighlight">\(T\)</span> if <span class="math notranslate nohighlight">\(v_{z}\)</span> gets large?</p>
</div>
</div>
<div class="section" id="constant-temperature-at">
<h3>Constant temperature <span class="math notranslate nohighlight">\(T_{L}\)</span> at <span class="math notranslate nohighlight">\(z=L\)</span><a class="headerlink" href="#constant-temperature-at" title="Permalink to this headline">¶</a></h3>
<p>A more useful second boundary condition is to assume <span class="math notranslate nohighlight">\(T(L) = T_{L}\)</span>.
In this case</p>
<div class="math notranslate nohighlight">
\[T(z) = T_{L} \left( \frac{1 - \mathrm{e}^{-(v_z z / \kappa})}{1 - \mathrm{e}^{-(v_z L / \kappa})} \right)\]</div>
</div>
</div>
<div class="section" id="the-peclet-number">
<h2>The Peclet number<a class="headerlink" href="#the-peclet-number" title="Permalink to this headline">¶</a></h2>
<p>The Peclet number is a useful value for estimating the relative influence of advective versus diffusive heat transfer processes.</p>
<div class="math notranslate nohighlight">
\[\mathrm{Pe} = \frac{v_{z}L}{\kappa}\]</div>
<p>Where <span class="math notranslate nohighlight">\(\kappa\)</span> is a parameter known as the <em>thermal diffusivity</em>.
<span class="math notranslate nohighlight">\(kappa\)</span> is the rock thermal conductivity <span class="math notranslate nohighlight">\(k\)</span> divided by the product of the density <span class="math notranslate nohighlight">\(\rho\)</span> and heat capacity <span class="math notranslate nohighlight">\(c_{\mathrm{p}}\)</span>, or <span class="math notranslate nohighlight">\(\kappa = k / (\rho c_{\mathrm{p}})\)</span>.</p>
<div class="admonition attention">
<p class="first admonition-title">Attention</p>
<p>If a typical rock thermal diffusivity is <span class="math notranslate nohighlight">\(\kappa = 10^{-6}\)</span> and typical continental crust is 35 km thick, how fast does it need to erode for advection exceed the effects of diffusion?</p>
<p class="last">How would this be different for erosion of the entire lithosphere?</p>
</div>
</div>
<div class="section" id="advection-diffusion-equation-take-home-messages">
<h2>Advection-diffusion equation take-home messages<a class="headerlink" href="#advection-diffusion-equation-take-home-messages" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li>Math gets a bit more complex, even for the ‘simplest’ cases; Often need numerical methods for more complex geometries</li>
<li>Behavior of the equation is strongly controlled by the boundary conditions</li>
<li>Even these simple equations can be quite useful. Advection can be a significant influence on the thermal field and these simple calculations allow you to estimate when it is a factor and its magnitude of influence.</li>
</ul>
</div>
<div class="section" id="caveats">
<h2>Caveats<a class="headerlink" href="#caveats" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li>Steady-state</li>
<li>1-D</li>
<li>Constants assumed to be constant :)</li>
<li>No heat production</li>
</ul>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="exercise-4.html" class="btn btn-neutral float-right" title="Exercise 4" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="overview.html" class="btn btn-neutral float-left" title="Lesson 4 overview" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2018, D. Whipp, Department of Geosciences and Geography, University of Helsinki.
      <span class="lastupdated">
        Last updated on Nov 19, 2018.
      </span>

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
    <p><br/><a rel="license" href="http://creativecommons.org/licenses/by-sa/4.0/"><img alt="Creative Commons License" style="border-width:0" src="https://i.creativecommons.org/l/by-sa/4.0/88x31.png" /></a><br /></a></p>
     


</footer>

        </div>
      </div>

    </section>

  </div>
  
<div class="rst-versions" data-toggle="rst-versions" role="note" aria-label="versions">
    <span class="rst-current-version" data-toggle="rst-current-version">
        <span class="fa fa-book"> Other Versions</span>
        v: 2018
        <span class="fa fa-caret-down"></span>
    </span>
    <div class="rst-other-versions">
        <dl>
            <dt>Tags</dt>
            <dd><a href="solving-advection.html">2018</a></dd>
        </dl>
        <dl>
            <dt>Branches</dt>
            <dd><a href="../../../2017/index.html">2017</a></dd>
            <dd><a href="../../../develop/lessons/L4/solving-advection.html">develop</a></dd>
            <dd><a href="../../../master/lessons/L4/solving-advection.html">master</a></dd>
        </dl>
    </div>
</div>


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>